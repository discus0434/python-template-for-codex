# プランタイトル（1開発単位）

## 概要
- 目的:
- 背景:
- 成果物:

## 要件合意（確定事項のみ）
- 目的/成果物:
- MVP:
- ノンゴール:
- 受け入れ条件:
- 制約/リスク:

## 設計（粒度を具体化）
### 変更対象ファイル
- 追加:
- 更新:
- 削除:

### モジュール/クラス/関数
- モジュール:
  - クラス/関数:
  - 責務:
  - 入力/出力:
  - 依存:

### データモデル（Pydantic）
- モデル名:
  - フィールド:
  - バリデーション:

### エラー/例外
- 例外名: 発生条件 / メッセージ

## タスク（実装レベル）
- [ ] 実装方針を決定（設計/分割/影響範囲）
- [ ] テストを先に作成（正常系/異常系/境界を具体列挙）
- [ ] 実装（対象ファイル/クラス/関数を明記）
- [ ] リファクタ（重複・複雑さの整理）
- [ ] セルフレビュー（plan-reviewer でプランとコード/テストの一致確認）
- [ ] ドキュメント更新（docs/REQUIREMENTS.md, docs/DESIGN.md など）

## テストケース（具体）
- 正常:
- 異常:
- 境界:

## 検証
- 実行コマンド: `make post-change`
- 追加の手動確認:

## 完了条件
- すべてのタスクが完了し、プランの内容が `docs/` に反映されている。

---

## 記入例（コピー後に削除すること）

### 概要
- 目的: 管理画面の一覧をCSVでエクスポートできるようにする
- 背景: 既存は画面表示のみで、外部共有の手段がない
- 成果物: CSVエクスポート機能（フィルタ適用後の一覧）

### 要件合意
- 目的/成果物: フィルタ適用済み一覧のCSVダウンロード
- MVP: フィルタ適用後の一覧のみ
- ノンゴール: PDF/Excel、スケジュール出力
- 受け入れ条件: 10件/1000件でCSVが取得できる
- 制約/リスク: 既存一覧APIの変更は不可

### 設計
- 変更対象ファイル
  - 追加: `src/app/exporter.py`
  - 更新: `tests/test_exporter.py`
- モジュール/クラス/関数
  - `CsvExporter.export(request: ExportRequest) -> bytes`
  - 責務: 一覧データをCSVに変換
  - 入力/出力: `ExportRequest` / CSV bytes
- データモデル
  - `ExportRequest(filters: dict[str, str], limit: int)`
- エラー/例外
  - `ValueError("invalid filter")`: 不正フィルタ指定時

### タスク
- [ ] `ExportRequest` と `CsvExporter` を追加
- [ ] `tests/test_exporter.py` に正常/異常/境界テスト追加
- [ ] plan-reviewer でプランとコード/テストの一致を確認
- [ ] docs更新（REQUIREMENTS/DESIGN/CHANGELOG）

### テストケース
- 正常: フィルタ適用後のCSV内容
- 異常: 不正フィルタで `ValueError`
- 境界: 0件/1000件

### 完了条件
- テストがすべて通る（`make post-change`）
- CSVエクスポートが要件どおり動作する
- docs更新が反映されている
